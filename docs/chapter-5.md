æœ¬èŠ‚å†…å®¹ç¿»è¯‘è‡ª `Princeton University` çš„ `Stata` æ•™ç¨‹ã€‚å½“ç„¶ï¼Œæˆ‘åšäº†é€‚å½“çš„ä¿®æ”¹ã€‚åŸæ–‡åœ°å€ï¼š[DATA & STATISTICAL SERVICES](http://www.princeton.edu/~otorres/Stata/)ã€‚

å½“ä½ çš„ `Stata` ä¸­å·²ç»å¯¼å…¥æ•°æ®åï¼Œå°±å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ¥æ¢ç´¢å®ƒä»¬ï¼š`describe`ã€`list`ã€`summarize`ï¼Œä»¥åŠ `codebook`ã€‚

## 1 Describing the data-æè¿°æ•°æ®

`describe` å‘½ä»¤å°†ä¸ºä½ æä¾›å½“å‰æ•°æ®é›†çš„ç›¸å…³ä¿¡æ¯ï¼ˆæ•°æ®é›†åç§°ç­‰ï¼‰å’Œå˜é‡çš„æ ¼å¼ï¼ˆâ€œæ˜¾ç¤ºæ ¼å¼â€ï¼‰ã€‚ç‚¹å‡»å›è½¦é”®æˆ–ç©ºæ ¼é”®å¯ä»¥çœ‹åˆ°å…¶ä½™çš„åˆ—è¡¨ã€‚è¾“å…¥ `help describe` ä»¥è·å¾—æ›´å¤šçš„ç»†èŠ‚ï¼ˆå¦‚æœâ€œ--æ›´å¤š--â€çš„ä¿¡æ¯è®©ä½ æ„Ÿåˆ°å›°æ‰°ï¼Œè¯·è¾“å…¥ `set more off`ï¼‰ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
describe

*- è¿”å›ç»“æœ
Contains data from E:\Stata16\ado\base/a/auto.dta
  obs:            74                          1978 Automobile Data
 vars:            12                          13 Apr 2018 17:45
                                              (_dta has notes)
--------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
--------------------------------------------------------------------------------
make            str18   %-18s                 Make and Model
price           int     %8.0gc                Price
mpg             int     %8.0g                 Mileage (mpg)
rep78           int     %8.0g                 Repair Record 1978
headroom        float   %6.1f                 Headroom (in.)
trunk           int     %8.0g                 Trunk space (cu. ft.)
weight          int     %8.0gc                Weight (lbs.)
length          int     %8.0g                 Length (in.)
turn            int     %8.0g                 Turn Circle (ft.)
displacement    int     %8.0g                 Displacement (cu. in.)
gear_ratio      float   %6.2f                 Gear Ratio
foreign         byte    %8.0g      origin     Car type
--------------------------------------------------------------------------------
Sorted by: foreign
```

## 2 The list command-`list` å‘½ä»¤

`list` å‘½ä»¤å°†ä»¥è¡¨æ ¼çš„å½¢å¼åˆ—å‡ºæ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
list price mpg in 1/5

*- è¿”å›ç»“æœ
     +-------------+
     | price   mpg |
     |-------------|
  1. | 4,099    22 |
  2. | 4,749    17 |
  3. | 3,799    22 |
  4. | 4,816    20 |
  5. | 7,827    15 |
     +-------------+
```

ç”±äºæ ·æœ¬æ€»æ•°æ¯”è¾ƒå¤šï¼Œè¿™é‡Œä½¿ç”¨ `in 1/5` æ¥å°†æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„æ•°æ®é™åˆ¶åœ¨å‰ 5 ä¸ªæ ·æœ¬ï¼Œå»æ‰è¿™ä¸ªé™åˆ¶ï¼Œå³å¯æ˜¾ç¤ºæ‰€æœ‰æ ·æœ¬ã€‚

## 3 The summarize command-`summarize` å‘½ä»¤

### 3.1 æè¿°æ€§ç»Ÿè®¡ä¹‹ `summarize`

`summarize` å‘½ä»¤ä¸ºä½ æä¾›äº†æ›´å¤šçš„æ•°æ®ä¿¡æ¯ï¼Œè¿”å›ç»“æœå°†ä¼šå‘Šè¯‰ä½ æ ·æœ¬çš„æ•°é‡ï¼Œå®ƒä»¬çš„å¹³å‡å€¼ã€æ ‡å‡†å·®å’Œæœ€å°ã€æœ€å¤§å€¼ã€‚æ³¨æ„å˜é‡å…¨ä¸º â€œ0â€ï¼Œå¯èƒ½æ„å‘³ç€è¿™äº›å˜é‡æ˜¯æ–‡æœ¬ï¼ˆæˆ–å­—ç¬¦ä¸²ï¼‰æ ¼å¼ï¼Œè€Œä¸æ˜¯æ•°å­—æ ¼å¼ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
summarize

*- è¿”å›ç»“æœ
    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        make |          0
       price |         74    6165.257    2949.496       3291      15906
         mpg |         74     21.2973    5.785503         12         41
       rep78 |         69    3.405797    .9899323          1          5
    headroom |         74    2.993243    .8459948        1.5          5
-------------+---------------------------------------------------------
       trunk |         74    13.75676    4.277404          5         23
      weight |         74    3019.459    777.1936       1760       4840
      length |         74    187.9324    22.26634        142        233
        turn |         74    39.64865    4.399354         31         51
displacement |         74    197.2973    91.83722         79        425
-------------+---------------------------------------------------------
  gear_ratio |         74    3.014865    .4562871       2.19       3.89
     foreign |         74    .2972973    .4601885          0          1
```

è¿”å›ç»“æœä¸­å˜é‡ `make` çš„è§‚æµ‹å€¼ä¸º 0ï¼Œç‚¹å¼€æ•°æ®åˆ™ä¸éš¾å‘ç°ï¼Œè¯¥å˜é‡ä¸ºæ–‡æœ¬å‹å˜é‡ï¼Œæ‰€æœ‰ä¸ä¼šå‚ä¸æè¿°æ€§ç»Ÿè®¡ã€‚

å¦‚æœä½ éœ€è¦è·å¾—æŸä¸ªå˜é‡çš„åˆ†ä½æ•°æˆ–è€…å…¶ä»–ç»Ÿè®¡é‡ï¼Œå¯ä»¥åœ¨å‘½ä»¤ä¹‹ååŠ ä¸Š `,detail`ï¼Œå¦‚ä¸‹ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
summarize price, detail

*- è¿”å›ç»“æœ
                            Price
-------------------------------------------------------------
      Percentiles      Smallest
 1%         3291           3291
 5%         3748           3299
10%         3895           3667       Obs                  74
25%         4195           3748       Sum of Wgt.          74

50%       5006.5                      Mean           6165.257
                        Largest       Std. Dev.      2949.496
75%         6342          13466
90%        11385          13594       Variance        8699526
95%        13466          14500       Skewness       1.653434
99%        15906          15906       Kurtosis       4.819188
```

æ­¤å¤–ï¼Œå¯¹äºä»»æ„åˆ†ä½æ•°ï¼Œå¯ä»¥å‚è€ƒ `Chapter 2-å˜é‡å¤„ç†` ä¸­ `2.5 ç¦»ç¾¤å€¼çš„å½±å“` ä¸­äº§ç”Ÿåˆ†ä½æ•°çš„æ–¹æ³•ã€‚æˆ–è€…ç›´æ¥çœ‹å¦‚ä¸‹å‘½ä»¤ã€‚

```stata
*- é€šè¿‡ summarize äº§ç”Ÿåˆ†ä½æ•°
	*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®é›†
	sysuse auto.dta
	*- ä½¿ç”¨ sum ä¸ detail æŸ¥çœ‹è¯¦ç»†
	sum price, detail
	*- æŸ¥çœ‹å‘½ä»¤è¿”å›å€¼
	return list
	*- å°†è¿”å›å€¼ä¸­çš„ p90 åˆ†ä½æ•°èµ‹å€¼ç»™å˜é‡ pctile90
	gen pctile90=r(p90)

*- é€šè¿‡ _pctile äº§ç”Ÿåˆ†ä½æ•°
	*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®é›†
	sysuse auto.dta
	*- ä½¿ç”¨ _pctile å‘½ä»¤ä¼°è®¡å˜é‡ price çš„ 25 å’Œ 75 åˆ†ä½æ•°
	_pctile price, p(25 75)
	*- æŸ¥çœ‹å‘½ä»¤è¿”å›å€¼
	return list
	*- å°†è¿”å›å€¼ä¸­çš„ p25 ä¸ p75 çš„åˆ†ä½æ•°èµ‹å€¼ç»™å˜é‡ pctile25 ä¸ pctile75
    gen pctile25=r(r1)
    gen pctile75=r(r2)
	*- åˆ©ç”¨ sum æ£€æŸ¥æ˜¯å¦ä¸€è‡´
	sum price, detail
	*- æµè§ˆå˜é‡ price ä»¥åŠå®ƒçš„ 25 ä¸ 75 åˆ†ä½æ•°
	browse price pctile25 pctile75
```

### 3.2 æè¿°æ€§ç»Ÿè®¡ä¹‹ `tabstat`

æ­¤å¤–ï¼Œ`tabstat` å‘½ä»¤ä¹Ÿå¯ä»¥å®ç°æè¿°æ€§ç»Ÿè®¡çš„æ“ä½œï¼Œæ¯”å¦‚ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
tabstat price mpg rep78, s(count mean sd min max)

*- è¿”å›ç»“æœ
   stats |     price       mpg     rep78
---------+------------------------------
       N |        74        74        69
    mean |  6165.257   21.2973  3.405797
      sd |  2949.496  5.785503  .9899323
     min |      3291        12         1
     max |     15906        41         5
----------------------------------------
```

å¹¶ä¸”ï¼Œ`tabstat` å‘½ä»¤æä¾›çš„ç»Ÿè®¡é‡éå¸¸ä¹‹å¤šï¼Œé€šè¿‡ `help tabstat`ï¼Œç„¶åç‚¹å‡» `optionsğŸ‘‰statistics` ä¸­çš„ `statname`ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰æ”¯æŒçš„ç»Ÿè®¡é‡ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è”åˆ `by()` é€‰é¡¹ï¼Œå®Œæˆåˆ†ç»„çš„æè¿°æ€§ç»Ÿè®¡ã€‚

## 4 Getting a codebook-è·å¾—ç¼–ç æ‰‹å†Œ

è¿™ä¸ªæ ‡é¢˜å¯èƒ½æ¯”è¾ƒæŠ½è±¡ä¸€ç‚¹ï¼Œä½†æ˜¯å¦‚æœä½ çœ‹è¿‡æˆ‘å‰é¢æåˆ°çš„å˜é‡ç±»å‹ï¼Œåœ¨ `Chapter 2-å˜é‡å¤„ç†` ä¸­ `2.2.1` å°èŠ‚æ‰€æåˆ°çš„ï¼Œæˆ‘æåˆ°è¿‡ `Stata` ä¸­çš„å˜é‡æœ‰ä¸‰ç§åŸºæœ¬çš„é¢œè‰²ï¼Œå…¶ä¸­æœ‰ä¸€ç§æ˜¯è“è‰²ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `codebook` å‘½ä»¤å¾ˆæ–¹ä¾¿åœ°æŸ¥çœ‹è“è‰²å˜é‡çš„å«ä¹‰ï¼Œæ¯”å¦‚ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
codebook foreign

*- è¿”å›ç»“æœ
--------------------------------------------------------------------------------
foreign                                                                 Car type
--------------------------------------------------------------------------------

                  type:  numeric (byte)
                 label:  origin

                 range:  [0,1]                        units:  1
         unique values:  2                        missing .:  0/74

            tabulation:  Freq.   Numeric  Label
                            52         0  Domestic
                            22         1  Foreign
```

`Stata` è‡ªå¸¦çš„æ•°æ®ä¸­ï¼Œ`foreign` å˜é‡æ˜¯è“è‰²çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `codebook` å‘½ä»¤æŸ¥çœ‹è¯¦æƒ…ï¼Œä¸Šè¿°ç»“æœæ„å‘³ç€æ•°å­— 0 è¡¨ç¤ºå›½äº§è½¦ï¼Œæ•°å­— 1 è¡¨ç¤ºè¿›å£è½¦ï¼ˆå›½å¤–çš„è½¦ï¼‰ã€‚

## 5. Basic commands-å…¶ä»–åŸºç¡€å‘½ä»¤

### 5.1 Frequencies (tab)-å•å˜é‡æ ·æœ¬é¢‘æ•°

æ¥ä¸Šä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æˆ‘å¸Œæœ›è¿›ä¸€æ­¥äº†è§£å›½äº§è½¦ä¸è¿›å£è½¦çš„é¢‘æ•°ï¼Œå³åœ¨æˆ‘çš„æ ·æœ¬ä¸­åˆ°åº•æœ‰å¤šå°‘ä¸ªå›½äº§è½¦ä»¥åŠå¤šå°‘ä¸ªè¿›å£è½¦ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ `tab` å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®
sysuse auto.dta

*- ä½¿ç”¨å‘½ä»¤
tab foreign

*- è¿”å›ç»“æœ
   Car type |      Freq.     Percent        Cum.
------------+-----------------------------------
   Domestic |         52       70.27       70.27
    Foreign |         22       29.73      100.00
------------+-----------------------------------
      Total |         74      100.00
```

å¦å¤–ï¼Œå¦‚æœä½ æƒ³ä¸€æ¬¡æ€§æŸ¥çœ‹å¤šä¸ªå˜é‡çš„å•å˜é‡é¢‘æ•°ï¼Œå¯ä»¥ä½¿ç”¨ `tab1` å‘½ä»¤ï¼Œå®ƒä¼šåˆ†è¡¨ä¾æ¬¡æ˜¾ç¤ºå¤šä¸ªå˜é‡çš„å…·ä½“é¢‘æ•°åˆ†å¸ƒã€‚

```stata
tab1 make foreign
// ç”±äºç»“æœå¤ªé•¿ï¼Œè¿™é‡Œå°±ä¸å±•ç¤ºäº†
```

### 5.2 Crosstabs (tab)-å¤šå˜é‡äº¤å‰é¢‘æ•°

å¤šå˜é‡äº¤å‰é¢‘æ•°æŒ‡çš„æ˜¯è§‚å¯Ÿä¸¤ä¸ªå˜é‡ä¹‹é—´çš„é¢‘æ•°å…³ç³»ï¼Œæ¯”å¦‚æŒ‰äººç§ç±»å‹ï¼ˆç™½ã€é»‘ä¸å…¶ä»–ï¼‰ç»Ÿè®¡å…¶å©šå§»æƒ…å†µï¼Œä»£ç å¦‚ä¸‹ã€‚

```stata
*- è°ƒç”¨è‡ªå¸¦çš„æ•°æ®é›†
sysuse nlsw88.dta

*- ä½¿ç”¨å‘½ä»¤
tab race married

*- è¿”å›ç»“æœ
           |        married
      race |    single    married |     Total
-----------+----------------------+----------
     white |       487      1,150 |     1,637 
     black |       309        274 |       583 
     other |         8         18 |        26 
-----------+----------------------+----------
     Total |       804      1,442 |     2,246 
```

è¿™æ ·æˆ‘ä»¬ä¾¿å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§‚å¯Ÿä¸åŒäººç§ä¹‹é—´çš„å©šå§»æƒ…å†µæ•°æ®ï¼Œæ¯”è¾ƒé€‚ç”¨äº `CFPS` è¿™æ ·å¼çš„è°ƒæŸ¥é—®å·ã€‚

åŒæ—¶ï¼Œé€šè¿‡é€‰æ‹© `row` æˆ–è€… `column` é€‰é¡¹ï¼Œå¯ä»¥è§‚å¯ŸæŒ‰è¡Œæˆ–è€…æŒ‰åˆ—è®¡ç®—çš„é¢‘ç‡ï¼Œæ¯”å¦‚ã€‚

```stata
*- æŒ‰è¡Œ
tab race married, row

*- è¿”å›ç»“æœ
+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

           |        married
      race |    single    married |     Total
-----------+----------------------+----------
     white |       487      1,150 |     1,637 
           |     29.75      70.25 |    100.00 
-----------+----------------------+----------
     black |       309        274 |       583 
           |     53.00      47.00 |    100.00 
-----------+----------------------+----------
     other |         8         18 |        26 
           |     30.77      69.23 |    100.00 
-----------+----------------------+----------
     Total |       804      1,442 |     2,246 
           |     35.80      64.20 |    100.00 

*- æŒ‰åˆ—
tab race married, column

*- è¿”å›ç»“æœ
+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

           |        married
      race |    single    married |     Total
-----------+----------------------+----------
     white |       487      1,150 |     1,637 
           |     60.57      79.75 |     72.89 
-----------+----------------------+----------
     black |       309        274 |       583 
           |     38.43      19.00 |     25.96 
-----------+----------------------+----------
     other |         8         18 |        26 
           |      1.00       1.25 |      1.16 
-----------+----------------------+----------
     Total |       804      1,442 |     2,246 
           |    100.00     100.00 |    100.00 
```

æœ€åï¼Œä¹Ÿå¯ä»¥åŒæ—¶åŠ å…¥ `row` ä¸ `column` çš„é€‰é¡¹æ¥ä¸€æ¬¡è¿”å›æŒ‰è¡Œæˆ–è€…æŒ‰åˆ—è®¡ç®—çš„å¤šç§é¢‘ç‡ã€‚

## 6 T-test Tæ£€éªŒ

ä¸»è¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªç»„åˆ«ä¹‹é—´çš„å‡å€¼å·®å¼‚ï¼Œæ¯”å¦‚ï¼Œæ¯”è¾ƒè¯»å¤§å­¦å’Œä¸è¯»å¤§å­¦å¯¹å·¥èµ„æ”¶å…¥çš„å½±å“ã€‚

```stata
*- è°ƒç”¨æ•°æ®
sysuse nlsw88.dta

*- ä½¿ç”¨å‘½ä»¤
ttest wage, by(collgrad)

*- è¿”å›ç»“æœ
Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. Err.   Std. Dev.   [95% Conf. Interval]
---------+--------------------------------------------------------------------
not coll |   1,714    6.910561    .1276104    5.283132    6.660273     7.16085
 college |     532    10.52606    .2742596    6.325833    9.987296    11.06483
---------+--------------------------------------------------------------------
combined |   2,246    7.766949    .1214451    5.755523    7.528793    8.005105
---------+--------------------------------------------------------------------
    diff |           -3.615502    .2753268               -4.155424    -3.07558
------------------------------------------------------------------------------
    diff = mean(not coll) - mean(college)                         t = -13.1317
Ho: diff = 0                                     degrees of freedom =     2244

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000
```

T æ£€éªŒçš„çš„åŸå‡è®¾ä¸ºä¸å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼Œæ ¹æ® `Ha: diff != 0, Pr(|T| > |t|) = 0.0000`ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­ï¼Œæ˜¾è‘—æ‹’ç»åŸå‡è®¾ï¼Œå³å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚æ‰€ä»¥æ˜¯å¦è¯»å¤§å­¦ä¸å·¥èµ„ä¹‹é—´çš„å›å½’åº”å½“æ˜¯æ˜¾è‘—çš„ï¼Œè¯·è¯»è€…è‡ªè¡ŒéªŒè¯ã€‚

## 7 One-way ANOVA-å•å› ç´ æ–¹å·®åˆ†æ

> è¯¥æ£€éªŒçš„ç›®çš„æ˜¯åˆ¤æ–­æ¯ä¸ªç»„çš„å¹³å‡æ•°æ˜¯å¦ç›¸åŒï¼Œå³å¯ä»¥è§†ä¸ºä¸€ç§ç»„é—´å·®å¼‚æ£€éªŒã€‚ä¸åŒäº T-test çš„ä¸¤ç»„ä¹‹é—´çš„å·®å¼‚æ¯”è¾ƒï¼ŒOne-way ANOVA å¯ä»¥å¯¹å¤šåˆ†ç±»çš„æŸä¸€ä¸ªå˜é‡æ„æˆçš„ä¸åŒç»„åˆ«è¿›è¡Œå‡å€¼å·®å¼‚æ£€éªŒã€‚-- By Shutter Zor

```stata
*- è°ƒç”¨æ•°æ®
sysuse nlsw88.dta

*- ä½¿ç”¨å‘½ä»¤
oneway wage race

*- è¿”å›ç»“æœ
                        Analysis of Variance
    Source              SS         df      MS            F     Prob > F
------------------------------------------------------------------------
Between groups      675.510282      2   337.755141     10.28     0.0000
 Within groups      73692.4571   2243   32.8544169
------------------------------------------------------------------------
    Total           74367.9674   2245   33.1260434

Bartlett's test for equal variances:  chi2(2) =  21.0482  Prob>chi2 = 0.000
```

ç»“æœæ„å‘³ç€ä¸åŒäººç§ä¹‹é—´çš„å·¥èµ„å…·æœ‰æ˜¾è‘—çš„å·®å¼‚ï¼ˆBetween groupsï¼ŒProb>F ä¸º 0.0000ï¼‰ï¼ŒåŒæ ·åœ°ï¼Œè¿™ä½¿å¾—ä¸¤è€…ä¹‹é—´çš„å›å½’ç»“æœä¹Ÿå˜å¾—æ˜¾è‘—äº†ï¼Œè¯·è¯»è€…è‡ªè¡ŒéªŒè¯ã€‚